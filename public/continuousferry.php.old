<?php

//  PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
//  For more information visit: http://www.projecthoneypot.org/
//  Copyright (C) 2004-2008, Unspam Technologies, Inc.
//  
//  This program is free software; you can redistribute it and/or modify
//  it under the terms of the GNU General Public License as published by
//  the Free Software Foundation; either version 2 of the License, or
//  (at your option) any later version.
//  
//  This program is distributed in the hope that it will be useful,
//  but WITHOUT ANY WARRANTY; without even the implied warranty of
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//  GNU General Public License for more details.
//  
//  You should have received a copy of the GNU General Public License
//  along with this program; if not, write to the Free Software
//  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
//  02111-1307  USA
//  
//  If you choose to modify or redistribute the software, you must
//  completely disconnect it from the Project Honey Pot Service, as
//  specified under the Terms of Service Use. These terms are available
//  here:
//  
//  http://www.projecthoneypot.org/terms_of_service_use.php
//  
//  The required modification to disconnect the software from the
//  Project Honey Pot Service is explained in the comments below. To find the
//  instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
//  
//  Generated On: Tue, 08 Jul 2008 11:53:51 -0400
//  For Domain: jwebgen.com
//  
//  

//  *** DISCONNECT INSTRUCTIONS ***
//  
//  You are free to modify or redistribute this software. However, if
//  you do so you must disconnect it from the Project Honey Pot Service.
//  To do this, you must delete the lines of code below located between the
//  *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
//  Terms of Service Use that you agreed to before downloading this software,
//  you may not recreate the deleted lines or modify this software to access
//  or otherwise connect to any Project Honey Pot server.
//  
//  *** START CUT HERE ***
//  
define('__REQUEST_HOST', 'hpr4.projecthoneypot.org');
define('__REQUEST_PORT', '80');
define('__REQUEST_SCRIPT','/cgi/serve.php');
//  
//  *** FINISH CUT HERE ***
//  

define('__HPOT_TAG1',    'efc2968da3e3a1d6460b1c79953721f7');
define('__HPOT_TAG2',    'e048c5ebf6f83e34cd7c55e296592015');
define('__HPOT_TAG3',    '34aa2473d1aa4705f92165addfe297ff');

define('__CLASS_STYLE_1','chuxurejih');
define('__CLASS_STYLE_2','zouo');

define('__DIV1',         'r7d6cr7c3t');

define('__VANITY_L1',    'MEMBER OF PROJECT HONEY POT');
define('__VANITY_L2',    'Spam Harvester Protection Network');
define('__VANITY_L3',    'provided by Unspam');

define('__DOC_TYPE1',    '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n');
define('__HEAD1',        '<html>\n<head>\n');
define('__HEAD2',        '<title>Radical,jwebgen.com</title>\n</head>\n');
define('__ROBOT1',       '<meta name="robots" content="follow,noindex,noarchive">\n');
define('__NOCOLLECT1',   '<meta name="no-email-collection" content="/">\n');
define('__TOP1',         '<body>\n<div align="center">\n');
define('__EMAIL1A',      '<a href="mailto:');
define('__EMAIL1B',      '" style="display: none;">');
define('__EMAIL1C',      '</a>');
define('__EMAIL2A',      '<a href="mailto:');
define('__EMAIL2B',      '" style="display:none;">');
define('__EMAIL2C',      '</a>');
define('__EMAIL3A',      '<a style="display: none;" href="mailto:');
define('__EMAIL3B',      '">');
define('__EMAIL3C',      '</a>');
define('__EMAIL4A',      '<a style="display:none;" href="mailto:');
define('__EMAIL4B',      '">');
define('__EMAIL4C',      '</a>');
define('__EMAIL5A',      '<a href="mailto:');
define('__EMAIL5B',      '"></a>');
define('__EMAIL5C',      '..');
define('__EMAIL6A',      '<span style="display: none;"><a href="mailto:');
define('__EMAIL6B',      '">');
define('__EMAIL6C',      '</a></span>');
define('__EMAIL7A',      '<span style="display:none;"><a href="mailto:');
define('__EMAIL7B',      '">');
define('__EMAIL7C',      '</a></span>');
define('__EMAIL8A',      '<!-- <a href="mailto:');
define('__EMAIL8B',      '">');
define('__EMAIL8C',      '</a> -->');
define('__EMAIL9A',      '<div id="'.__DIV1.'"><a href="mailto:');
define('__EMAIL9B',      '">');
define('__EMAIL9C',      '</a></div><br><script language="JavaScript" type="text/javascript">document.getElementById(\''.__DIV1.'\').innerHTML=\'\';</script>');
define('__EMAIL10A',     '<a href="mailto:');
define('__EMAIL10B',     '"><!-- ');
define('__EMAIL10C',     ' --></a>');
define('__LEGAL1',       '');
define('__LEGAL2',       '\n');
define('__STYLE1',       '\n<style>a.'.__CLASS_STYLE_1.'{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>');
define('__VANITY1',      '<table cellspacing="0"cellpadding="0"border="0"style="background:#999;width:230px;"><tr><td valign="top"style="padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;"><span style="font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;">@</span></td><td valign="top" align="left" style="padding:3px 0 0 4px;"><a href="http://www.projecthoneypot.org/" class="'.__CLASS_STYLE_1.'">'.__VANITY_L1.'</a><br><a href="http://www.unspam.com"class="'.__CLASS_STYLE_1.'">'.__VANITY_L2.'<br>'.__VANITY_L3.'</a></td></tr></table>\n');
define('__BOTTOM1',      '</div>\n</body>\n</html>\n');


function getLegalContent() { return '<table cellspacing="0" cellpadding="0" border="0"><tr>\n<td><font face="courier">&nbsp; &nbsp; &nbsp; &nbsp; <b><font color=white>d</font></b>&nbsp; <b><font color=white>f</font></b>&nbsp; &nbsp; <b><font color=white>p</font><font color=white>t</font></b>&nbsp; <br>&nbsp;<br>The &#119;eb&#115;i&#116;&#101; from whi<br>to you<font color=white>p</font>&#115;ubj&#101;&#99;t &#116;o<font color=white>o</font>th<br>other te&#114;ms governin<br>Website<font color=white>k</font>y&#111;u accept<font color=white>p</font>t<br>r&#101;ad them<font color=white>k</font>careful&#108;&#121;&#46;<br>&#97;gen&#116;s of the ind&#105;vi<br>them. The access r&#105;g<br>non-transferable wi&#116;<br>W&#101;bsite.<br><br><b><font color=white>k</font><font color=white>c</font></b>&nbsp; &nbsp; <b><font color=white>s</font></b>&nbsp; &nbsp; &nbsp; &nbsp; <b>S<span style="display: none">airtoair liquid palmate ludicrous bedraggled</span>P<span style="display: none">precautionary common</span>E&#67;I</b><br>&nbsp;<br>Special rest&#114;ictions<br>Non-&#72;um&#97;n Vis&#105;tors. <br>spiders, bots,<font color=white>c</font>index<br>&#112;rogr&#97;ms de&#115;igned<font color=white>k</font>to<br>aut&#111;matically.<br><br>Email ad&#100;resses on t<br>It<font color=white>f</font>&#105;&#115; recognized t<span style="display: none">approval idea awestruck spiritual</span>ha<br>&#97;lon&#101;. You &#97;c&#107;nowled<br>h&#97;s a value n&#111;t l&#101;ss<br>s&#116;&#111;rage, and/o&#114; dist<br>valu&#101; of<font color=white>a</font>th&#101;s<span style="display: none">draconian puppies page</span>e add&#114;e<br>st&#111;ring this Website<br>agreeme&#110;t and expres<br><br>&nbsp; &nbsp; <b><font color=white>d</font></b>&nbsp;<b><font color=white>g</font></b>&nbsp; &nbsp; &nbsp; <b><font color=white>g</font></b>&nbsp; &nbsp; &nbsp; <br>&nbsp;<br>&#69;ach pa&#114;ty &#97;grees th<br>agains&#116; the oth&#101;r in<br>("Jud&#105;cia&#108;<font color=white>f</font>&#65;cti&#111;n") <br>the<font color=white>t</font>registere&#100; Adm&#105;n<br>s&#117;ch laws are ap&#112;li&#101;<br>&#97;nd perf&#111;rme<span style="display: none">eccentric chamber basic agent</span>d en<span style="display: none">nomadic</span>tire<br>o&#102; federal and state<br>any a&#99;tion b&#114;o<span style="display: none">irish calm colts limiting alteration</span>&#117;&#103;ht a<br>Service.<font color=white>p</font>You co&#110;s<span style="display: none">triangular</span>ent<br>&#116;he &#97;bove a&#103;&#114;eement&#46;<br><br>&nbsp; &nbsp;&nbsp; <b><font color=white>i</font></b>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <b><font color=white>e</font></b>&nbsp; &nbsp; <br>&nbsp;<br>Y&#111;u consent<font color=white>e</font>t&#111; havin<br>m&#97;&#121; appear somew<span style="display: none">paper spontaneous high autonomy capsulate</span>here<br>abuse. T&#104;e<font color=white>o</font>I&#100;en&#116;ifie<br>Visitors agree no&#116; t<br><br>VISI&#84;ORS A&#71;&#82;EE THAT <br>&#80;ARTY &#79;R SEN&#68;ING<font color=white>c</font>ANY<br>S&#85;BSEQUENT BREACH OF<br></font></td>\n<td><font face="courier">&nbsp;&nbsp; <b><font color=white>i</font><font color=white>s</font></b>&nbsp;<b><font color=white>f</font>TERM&#83;</b>&nbsp;<b>AND<font color=white>i</font>CO&#78;</b><br><br>ch<font color=white>d</font>&#121;ou accessed th&#105;s<br>e following<font color=white>e</font>&#99;o&#110;&#100;&#105;tio<br>g<font color=white>a</font>acces&#115; t&#111;<font color=white>s</font>the W&#101;bs<br>&#104;e&#115;e ter<span style="display: none">warm</span>ms and condi<br>&nbsp;A&#110;y &#78;&#111;n-Human Visit<br>dual(s) who controls<br>hts &#103;ranted<font color=white>c</font>&#116;o &#121;&#111;u u<br>ho&#117;t t&#104;e express wri<br><br><br><b>AL</b>&nbsp;<b>&#76;ICENS&#69;</b>&nbsp;<b>RESTRI&#67;TI</b><br><br>&nbsp;on a visitor\'s l<span style="display: none">new thing</span>i&#99;e<br>Non-Human Visitors i<br>ers,<font color=white>o</font>robot&#115;, &#99;raw&#108;e&#114;<br>&nbsp;&#97;ccess&#44; read, comp&#105;<br><br><br>his site are c<span style="display: none">castle balloon borough veery didactic</span>onside<br>t &#116;hese e&#109;ail add<span style="display: none">bowel sharp equivalent</span>&#114;es<br>&#103;e and agree th&#97;t ea<br>&nbsp;&#116;h&#97;n U&#83; $50. You<font color=white>e</font>fu<br>ribution o&#102; t<span style="display: none">sacramental worried humdrum</span>hese<span style="display: none">beavers special</span>&nbsp;&#97;d<br>sses. Intentional &#99;o<br>\'s email a&#100;&#100;r&#101;sses i<br>sly proh&#105;bited&#46;<br><br>&nbsp; &nbsp;&nbsp; <b>AP&#80;L&#73;CABLE</b>&nbsp;<b>LAW</b>&nbsp;<br><br>&#97;t any suit, a&#99;ti<span style="display: none">string tory</span>on <br>&nbsp;c&#111;nne&#99;tion with<font color=white>p</font>or <br>s&#104;all<font color=white>a</font>be gov&#101;rned by<br>istrative Cont<span style="display: none">municipal spiritual lambs piglets</span>act (t<br>d t&#111; &#97;gre&#101;ments &#98;e&#116;w<br>ly within the<font color=white>t</font>Admin <br>&nbsp;court&#115;<font color=white>i</font>with&#105;n<font color=white>d</font>the A<br>gainst him in conne&#99;<br>&nbsp;to electronic se&#114;vi<br><br><br>&nbsp;<b><font color=white>i</font><font color=white>g</font></b>&nbsp;<b>RECORDS</b>&nbsp;<b>OF</b>&nbsp;<b>&#86;IS&#73;T</b><br><br>g your I&#110;terne&#116; Prot<br>&nbsp;on this pa&#103;&#101; (the "<span style="display: none">impulsive</span><br>r is u&#110;iquely matche<br>o use &#116;his ad&#100;ress &#102;<br><br>HARVESTING, G&#65;TH&#69;RIN<br>&nbsp;MESSA&#71;E(S) TO<font color=white>f</font>THE I<br>&nbsp;TH&#69;SE TERMS OF SE&#82;&#86;<br></font></td>\n<td><font face="courier"><b>DITIONS</b>&nbsp;<b>OF</b>&nbsp;<b>U&#83;E</b>&nbsp;<br><br>&nbsp;agre&#101;m&#101;nt ("t&#104;e W&#101;b<br>ns. Thes<span style="display: none">wonder</span>e terms are <br>i&#116;e&#46; &#66;y vis&#105;t<span style="display: none">troops feather</span>ing (in<br>tions (the "Te&#114;ms of<br>ors to the We&#98;si&#116;e s<br>&#44; aut&#104;ors or<font color=white>f</font>otherwi<br>nder t&#104;e<font color=white>e</font>Terms of Se<br>&#116;te&#110; permission of<font color=white>g</font>t<br><br><br><b>ONS</b>&nbsp;<b>F&#79;R</b>&nbsp;<b>&#78;ON&#45;HUMAN</b>&nbsp;<b>VI<span style="display: none">different</span></b><br><br>nse &#116;o acce&#115;s<font color=white>p</font>the We<br>ncl&#117;de, bu<span style="display: none">heavy barred suburb</span>t are no&#116;<font color=white>f</font><br>s, harvesters, o&#114; an<br>le &#111;r &#103;at<span style="display: none">limitation wellknown thin massive</span>he&#114; conte&#110;t<br><br><br>red prop&#114;ietary inte<br>&#115;es are pro&#118;ided fo&#114;<br>ch<font color=white>a</font>&#101;mail<font color=white>f</font>&#97;&#100;dress the<br>rther agree tha&#116; the<br>dresses s&#117;bstan&#116;i&#97;ll<br>llection&#44; harvesting<br>s recogn&#105;zed as a vi<br><br><br><b>A&#78;D</b>&nbsp;<b>&#74;U<span style="display: none">interpersonal overjoyed</span>RISDICTION</b>&nbsp;<br><br>or proc&#101;eding brough<br>arising from<font color=white>f</font>t<span style="display: none">greathearted minor fear wrinkle camerashy</span>h&#101; Ter<br><font color=white>h</font>the law of the stat<br>he "Adm<span style="display: none">on freelance quotation</span>in Sta&#116;e")<font color=white>c</font>fo<br>een Adm&#105;n<font color=white>c</font>&#83;tate &#114;esi<br>St&#97;te.<font color=white>s</font>You<font color=white>d</font>&#99;onse&#110;t t<br>d&#109;in<font color=white>f</font>State.<font color=white>p</font>You con&#115;<br>tion<font color=white>f</font>wit<span style="display: none">actinoid loop threephase</span>h<font color=white>e</font>&#98;reache&#115;<font color=white>p</font>o<br>ce of process<font color=white>t</font>regar&#100;<br><br><br><b>&#79;R</b>&nbsp;<b>US&#69;</b>&nbsp;<b>AND</b>&nbsp;<b>AB&#85;&#83;E</b>&nbsp;<br><br>oc<span style="display: none">button truant ugliest crystalloid</span>ol add&#114;ess<font color=white>g</font>recor&#100;e<br>Ide&#110;t&#105;fie&#114;") if we s<br>d to your I&#110;terne&#116; P<br>or any reason.<br><br>G, &#83;TORING&#44; TRANS&#70;ER<br>DENTIF&#73;E&#82; CON&#83;TITUTE<br>ICE.<br></font></td>\n<td><font face="courier"><br><br>site") i&#115; provi&#100;ed<br>in addition t&#111;<font color=white>k</font>any<br>&nbsp;&#97;ny manne&#114;) th&#101;<br>&nbsp;S&#101;&#114;vice").<font color=white>p</font>Please<br>ha&#108;l be c&#111;&#110;sid&#101;red<br>s&#101; makes &#117;se of<br>rvi&#99;e<span style="display: none">exceptional scalene eternal working</span>&nbsp;a&#114;e<br>he owne<span style="display: none">side stage</span>r &#111;f the<br><br><br><b>SITORS</b>&nbsp;<br><br>bsit&#101; apply to<br>&#108;i&#109;it&#101;d to, web<br>y other co&#109;&#112;&#117;ter<br>&nbsp;&#102;rom &#116;he We&#98;site<br><br><br>lle&#99;tual pro&#112;erty.<br>&nbsp;human vi&#115;it&#111;&#114;&#115;<br>&nbsp;&#87;e&#98;site<font color=white>h</font>co&#110;t&#97;i&#110;&#115;<br>&nbsp;co&#109;pilati&#111;n,<br>&#121;<font color=white>k</font>diminishes the<span style="display: none">sighted highpressure developed</span><br>, &#103;at&#104;ering, &#97;nd/or<br>olation &#111;f this<br><br><br><br><br>t by s&#117;ch party<br>ms<font color=white>h</font>of Service<br>e of res&#105;d&#101;nce o&#102;<br>r t&#104;e Website as<br>d&#101;nt&#115;<font color=white>d</font>entered int&#111;<br>o the jurisdicti&#111;&#110;<br>&#101;n&#116; to the &#118;en&#117;e in<br>f<span style="display: none">horseless mono</span>&nbsp;&#116;hese Terms of<br>ing a&#99;t&#105;ons under<br><br><br><br><br>d.<font color=white>a</font>An email a&#100;d&#114;ess<br>u&#115;pect<font color=white>k</font>p&#111;ten<span style="display: none">glace user responsible</span>&#116;ial<br>ro&#116;ocol addre<span style="display: none">bold permission big stipendiary poet</span>s&#115;.<br><br><br>&#82;ING<font color=white>i</font>TO A THIRD<br>S A<span style="display: none">transfer</span>N &#65;CCEPTAN&#67;E AND<br><br></font></td>\n</tr>\n</table>\n<br>'; }


?><?php 

// 
// PROXY SUPPORT
//  
// This honey pot script supports Proxies. If your webserver requires a proxy
// for outbound connections you may configure this honey pot's settings to use
// a proxy.
//
// For more information, visit: 
//     http://www.projecthoneypot.org/settings_help.php
//
//



function formatHTML($s) {
    return str_replace('\n',"\n",$s);
}

function getDocType()       { return formatHTML(__DOC_TYPE1); }
function getHeadHTML1()     { return formatHTML(__HEAD1); }
function getRobotHTML()     { return formatHTML(__ROBOT1); }
function getNoCollectHTML() { return formatHTML(__NOCOLLECT1); }
function getHeadHTML2()     { return formatHTML(__HEAD2); }
function getTopHTML()       { return formatHTML(__TOP1); }
function getEmailHTML($method,$m) { 
    switch ($method) {
    case 0: return "";
    case 1: return formatHTML(__EMAIL1A.$m.__EMAIL1B.$m.__EMAIL1C); 
    case 2: return formatHTML(__EMAIL2A.$m.__EMAIL2B.$m.__EMAIL2C); 
    case 3: return formatHTML(__EMAIL3A.$m.__EMAIL3B.$m.__EMAIL3C); 
    case 4: return formatHTML(__EMAIL4A.$m.__EMAIL4B.$m.__EMAIL4C); 
    case 5: return formatHTML(__EMAIL5A.$m.__EMAIL5B); 
    case 6: return formatHTML(__EMAIL6A.$m.__EMAIL6B.$m.__EMAIL6C); 
    case 7: return formatHTML(__EMAIL7A.$m.__EMAIL7B.$m.__EMAIL7C); 
    case 8: return formatHTML(__EMAIL8A.$m.__EMAIL8B.$m.__EMAIL8C); 
    case 9: return formatHTML(__EMAIL9A.$m.__EMAIL9B.$m.__EMAIL9C); 
    }
    return formatHTML(__EMAIL10A.$m.__EMAIL10B.$m.__EMAIL10C); 
}
function getLegalHTML()   { return formatHTML(__LEGAL1.(getLegalContent()).__LEGAL2); }
function getStyleHTML()   { return formatHTML(__STYLE1); }
function getVanityHTML()  { return formatHTML(__VANITY1); }
function getBottomHTML()  { return formatHTML(__BOTTOM1); }

function readSettings() {
    $settings      = NULL;
    $settings_file = dirname(__FILE__)."/phpot_settings.php";

    if (is_file($settings_file) && is_readable($settings_file)) {
        $fp = fopen($settings_file,"r");
        $contents = "";
        while (!feof($fp)) {
            $contents .= fread($fp, 8192);
        }
        fclose($fp);

        $lines = explode("\n",$contents);
        foreach ($lines as $line) {
            if (trim($line) !== "") {
                list ($setting, $value) = @explode(":",$line,2);
                switch ($setting) {
                case "proxy_host": 
                    $settings["sock_host"] = trim($value);
                    break;
                case "proxy_port":
                    $settings["sock_port"] = trim($value);
                    break;
                }
                if (trim($value) !== "") {
                    $settings[trim($setting)] = trim($value);
                }
            }
        }
    }

    if (isset($settings["proxy_host"]) && isset($settings["proxy_port"]) && !isset($settings["use_proxy"])) {
        $settings["use_proxy"] = "1";
    } else {
        $settings["use_proxy"] = "0";
    }

    if (isset($settings["proxy_user"]) && isset($settings["proxy_pass"]) && !isset($settings["proxy_auth"])) {
        $settings["proxy_auth"] = "basic";
    } else {
        $settings["proxy_auth"] = "none";
    }

    if (!isset($settings["sock_host"])) $settings["sock_host"] = __REQUEST_HOST;
    if (!isset($settings["sock_port"])) $settings["sock_port"] = __REQUEST_PORT;

    return $settings;
}

function performRequest($request) {
    $response = "";

    $settings = readSettings();

    if ($settings["use_proxy"] == "1") {
        // POST via proxy
        $post_url = "http://".__REQUEST_HOST.":".__REQUEST_PORT.__REQUEST_SCRIPT;

        $head  = "POST ".$post_url." HTTP/1.0\r\n";
        //$head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        if ($settings["proxy_auth"] == "basic") {
            $head .= "Proxy-Authorization: Basic ".base64_encode($settings["proxy_user"].":".$settings["proxy_pass"])."\r\n";
        }
        $head .= "Cache-Control: no-store, no-cache\r\n";
        $head .= "Accept: */*\r\n";
        $head .= "Pragma: no-cache\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";

    } else {
        // POST directly
        $head  = "POST ".__REQUEST_SCRIPT." HTTP/1.1\r\n";
        $head .= "Host: ".__REQUEST_HOST."\r\n";
        $head .= "User-Agent: PHPot ".__HPOT_TAG2."\r\n";
        $head .= "Content-Type: application/x-www-form-urlencoded\r\n";
        $head .= "Content-Length: ".strlen($request)."\r\n";
        $head .= "Connection: close\r\n\r\n";
    }
    
    $errno  = NULL;
    $errstr = NULL;
    $fd = @fsockopen ($settings["sock_host"], $settings["sock_port"], $errno, $errstr, 20);

    if (!$fd) {
        // Socket Error
        die("\n<BR>Unable to contact the Server. Are outbound connections disabled? (If a proxy is required for outbound traffic, you may configure the honey pot to use a proxy. For instructions, visit http://www.projecthoneypot.org/settings_help.php)<BR>\n");
        return "-1";
    } else {

        fputs($fd,$head.$request);
        while(!feof($fd)) {
            $response .= fgets($fd,4096);
        }
        fclose($fd);
    }

    return $response;
}

function prepareRequest() {
    $postvars          = array();
    $postvars["tag1"]  = __HPOT_TAG1;
    $postvars["tag2"]  = __HPOT_TAG2;
    $postvars["tag3"]  = __HPOT_TAG3;
    if (!($handle = fopen(__FILE__,"r"))) {
        die("\n<BR>Unable to read contents of ".__FILE__." for hashing<BR>\n");
        return -2;
    }
    $contents = "";
    while (!feof($handle)) {
        $contents .= fread($handle, 8192);
    }
    fclose($handle);
    $postvars["tag4"]   = md5(ereg_replace("[^a-zA-Z0-9]","",$contents));
    $postvars["ip"]    = $_SERVER["REMOTE_ADDR"];
    $postvars["svrn"]  = $_SERVER["SERVER_NAME"];  
    $postvars["svp"]   = $_SERVER["SERVER_PORT"];  
    $postvars["svip"]  = isset($_SERVER["SERVER_ADDR"]) ? $_SERVER["SERVER_ADDR"] : "";
    $postvars["rquri"]   = isset($_SERVER["REQUEST_URI"]) ? $_SERVER["REQUEST_URI"] : "";
    $postvars["phpself"] = str_replace(' ','%20',$_SERVER["PHP_SELF"]);
    $postvars["version"] = "php-".phpversion();
    $postvars["sn"]     = str_replace(' ','%20',$_SERVER["SCRIPT_NAME"]);
    $postvars["ref"]    = isset($_SERVER["HTTP_REFERER"]) ? $_SERVER["HTTP_REFERER"] : "";
    $postvars["uagnt"]  = isset($_SERVER["HTTP_USER_AGENT"]) ? $_SERVER["HTTP_USER_AGENT"] : "";
    if (isset($_POST) && count($_POST) > 0) {
        $postvars["has_post"] = count($_POST);
        for (reset($_POST);list($k,$v) = each($_POST);) {
            $postvars["post|".$k] = $v;
        }
        reset($_POST);
    }
    if (isset($_GET) && count($_GET) > 0) {
        $postvars["has_get"] = count($_GET);
        for (reset($_GET);list($k,$v) = each($_GET);) {
            $postvars["get|".$k] = $v;
        }
        reset($_GET);
    }

    return $postvars;
}

function transcribeResponse(& $response) {
    $settings  = NULL;
    $arr       = explode("\n",$response);
    $isParam   = FALSE;

    
    for ($i=0;list(,$v)=each($arr);$i++) {
        if ($v == "<END>")   $isParam = FALSE;

        if ($isParam) {          
            $pieces = explode("=",$v,2);
            $settings[$pieces[0]] = urldecode($pieces[1]);
        }
        if ($v == "<BEGIN>") $isParam = TRUE;
    }
    

    if ($settings["directives"]) {
        $settings["directives"] = explode(",",$settings["directives"]);
    }

    return $settings;
}

header("Cache-Control: no-store, no-cache");
header("Pragma: no-cache");

$response  = "";
$request   = "";
$post      = prepareRequest();

for (reset($post);list($k,$v) = each($post);) {
    $request .= "&".urlencode($k)."=".urlencode(stripslashes($v));
}
$request    = substr($request,1);
$response   = performRequest($request);
if ($response == "-1") {
    exit();
}
$settings   = transcribeResponse($response);

$directives   = $settings["directives"];
$email        = isset($settings["email"]) ? $settings["email"] : "";
$emailmethod  = isset($settings["emailmethod"]) ? $settings["emailmethod"] : 0;




?>
<?php echo (isset($directives[0]) && $directives[0]==1) ? getDocType()    : ""; ?>
<?php echo (isset($settings["injDocType"])) ? formatHTML($settings["injDocTypeMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML1()   : ""; ?>
<?php echo (isset($settings["injHead1HTML"])) ? formatHTML($settings["injHead1HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[8]) && $directives[8]==1) ? getRobotHTML()   : ""; ?>
<?php echo (isset($settings["injRobotHTML"])) ? formatHTML($settings["injRobotHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[9]) && $directives[9]==1) ? getNoCollectHTML()   : ""; ?>
<?php echo (isset($settings["injNoCollectHTML"])) ? formatHTML($settings["injNoCollectHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[1]) && $directives[1]==1) ? getHeadHTML2()   : ""; ?>
<?php echo (isset($settings["injHead2HTML"])) ? formatHTML($settings["injHead2HTMLMsg"]) : ""; ?>
<?php echo (isset($directives[2]) && $directives[2]==1) ? getTopHTML()    : ""; ?>
<?php echo (isset($settings["injTopHTML"])) ? formatHTML($settings["injTopHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["actMsgOn"])) { 
       echo formatHTML($settings["actMsg"]); 
   }
   if (isset($settings["errMsgOn"])) { 
       echo formatHTML($settings["errMsg"]); 
   }
   if (isset($settings["customMsgOn"])) { 
       echo formatHTML($settings["customMsg"]); 
   }
?>
<?php echo (isset($directives[3]) && $directives[3]==1) ? getLegalHTML()  : ""; ?>
<?php echo (isset($settings["injLegalHTML"])) ? formatHTML($settings["injLegalHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altLegalOn"])) { 
       echo formatHTML($settings["altLegalMsg"]); 
   } 
?>
<?php echo (isset($directives[4]) && $directives[4]==1) ? getEmailHTML(intval($emailmethod),$email)  : ""; ?>
<?php echo (isset($settings["injEmailHTML"])) ? formatHTML($settings["injEmailHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[5]) && $directives[5]==1) ? getStyleHTML()  : ""; ?>
<?php echo (isset($settings["injStyleHTML"])) ? formatHTML($settings["injStyleHTMLMsg"]) : ""; ?>
<?php echo (isset($directives[6]) && $directives[6]==1) ? getVanityHTML() : ""; ?>
<?php echo (isset($settings["injVanityHTML"])) ? formatHTML($settings["injVanityHTMLMsg"]) : ""; ?>
<?php
   if (isset($settings["altVanityOn"])) {
        echo formatHTML($settings["altVanityMsg"]);
    }
?>
<?php echo (isset($directives[7]) && $directives[7]==1) ? getBottomHTML() : ""; ?>
<?php echo (isset($settings["injBottomHTML"])) ? formatHTML($settings["injBottomHTMLMsg"]) : ""; ?>
